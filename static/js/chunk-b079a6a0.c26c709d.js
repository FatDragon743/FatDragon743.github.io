(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b079a6a0"],{"094d":function(t,e,a){},"31b6":function(t,e,a){"use strict";var s=a("094d"),i=a.n(s);i.a},4839:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-tag",{staticClass:"txt1"},[t._v("订单整体测试情况")]),t._v("现在显示为订单号为：\n    "),a("em",{staticStyle:{color:"red"}},[t._v(t._s(t.order_num))]),t._v(" 的内容\n  ")],1),[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-tag",{staticClass:"txt1"},[t._v("\n        整体通过率 ：\n        "),a("em",{staticStyle:{color:"red"}},[t._v(t._s(100*t.stats.fpy)+"%")])]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.handleComplete()}}},[t._v("确认订单完成")])],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-tag",{staticClass:"txt1"},[t._v("整体错误 TopIssue")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.stats.top_err_order,"highlight-current-row":"",border:""}},[a("el-table-column",{attrs:{prop:"count(*)",label:"count(*)"}}),a("el-table-column",{attrs:{prop:"error_code",label:"错误类型"}}),a("el-table-column",{attrs:{prop:"station",label:"测试站名称"}})],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-tag",{staticClass:"txt1"},[t._v("实时完成情况")]),a("el-button",{attrs:{type:"danger",size:"small",disabled:t.ifFlash},on:{click:function(e){return t.reflash()}}},[t._v("刷新")])],1),a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{width:"80%",height:"400px",margin:"auto"},attrs:{id:"chartLine"}})])],a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-tag",{staticClass:"txt1"},[t._v("订单产品情况")])],1),a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:t.filters}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"产品当前测试站状态"},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}},[a("el-option",{attrs:{label:"全部",value:"4"}}),a("el-option",{attrs:{label:"通过",value:"0"}}),a("el-option",{attrs:{label:"未通过",value:"1"}}),a("el-option",{attrs:{label:"返修中",value:"2"}}),a("el-option",{attrs:{label:"返修待复测",value:"3"}})],1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"产品序列号",clearable:""},model:{value:t.filters.sn,callback:function(e){t.$set(t.filters,"sn",e)},expression:"filters.sn"}},[a("template",{slot:"prepend"},[t._v("产品序列号")])],2)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"当前所处测试站",clearable:""},model:{value:t.filters.at_station,callback:function(e){t.$set(t.filters,"at_station",e)},expression:"filters.at_station"}},[a("template",{slot:"prepend"},[t._v("当前所处测试站")])],2)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getProductStats}},[t._v("根据状态查询")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.ProductStatList,"highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"test_cnt",label:"各测试站测试次数"}}),a("el-table-column",{attrs:{prop:"test_time",label:"各测试站测试时长"}})],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":t.pageLimit,total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],2)},i=[],n=(a("f763"),a("cb1d")),o=a("8b55"),r=a("24ce"),l=a.n(r),c=a("4ec3"),u=(a("4f45"),{data:function(){var t;return t={myvar:"",ifFlash:!0,filters:{status:""},user_id:"",order_num:"",last_timestamp_comp:"",last_timestamp_comp2:"",last_timestamp_reject:"",listLoading2:!0,stats:{},total:10,page:1,pageLimit:10},Object(n["a"])(t,"filters",{sn:"",at_station:"",status:""}),Object(n["a"])(t,"ProductStatList",[]),Object(n["a"])(t,"listLoading",!0),t},methods:{getProductStats:function(){var t=this,e={user_id:this.user_id,page:this.page,pageLimit:this.pageLimit,order_num:this.order_num};for(var a in this.filters)this.filters[a]&&(e[a]=this.filters[a]);console.log("getProductStats para :",e),Object(c["m"])(e).then(function(e){var a=e.code,s=e.msg;console.log("getProductStatList msg: ",e),200==a||(t.$message({message:s||"您的查询结果为空，请重新查询",type:"error"}),t.listLoading=!1)})},handleCurrentChange:function(){this.page=val,this.getProductStats()},getTestStationStats:function(){var t=this,e={user_id:this.user_id,order_num:this.order_num};""!=this.last_timestamp_comp&&(e.last_timestamp_comp=this.last_timestamp_comp),Object(c["o"])(e).then(function(e){var a=e.code,s=e.msg;console.log("getTestStationStat msg: ",e),200==a||(t.$message({message:s,type:"error"}),t.listLoading=!1)})},drawLineChart:function(){var t=["时间点","完成数量"],e=[].concat(this.stats.stat_complete_quantity["values"]);e.unshift(t),this.chartLine=l.a.init(document.getElementById("chartLine")),this.chartLine.setOption({backgroundColor:"#EEE685",tooltip:{trigger:"axis"},dataset:{source:e},grid:{bottom:"5%",containLabel:!0},xAxis:{name:"时间",type:"category",boundaryGap:[.5,.5]},yAxis:{type:"value",name:"完成数量",minInterval:1,boundaryGap:[0,.1]},series:[{type:"line"}]})},handleTest:function(t,e){this.$router.push({path:"/test",name:"测试情况",params:{user_id:this.user_id,order_num:this.order_num}})},handleComplete:function(t,e){var a=this,s={user_id:this.user_id,order_num:this.order_num};Object(c["x"])(s).then(function(t){var e=t.code,s=t.msg;console.log(s),200==e?a.$message({message:s,type:"success"}):a.$message({message:s,type:"error"})})},getOrderStats:function(){var t=this,e={user_id:this.user_id,order_num:this.order_num};""!=this.last_timestamp_comp&&(e.last_timestamp_comp=this.last_timestamp_comp),Object(c["l"])(e).then(function(e){var a=e.code,s=e.msg;if(console.log("getOrderStats msg: ",e),200==a){s.top_err_order=o["a"].getList(JSON.parse(s.top_err_order)),Object.assign(t.stats,s),t.listLoading=!1;try{t.last_timestamp_comp=s.stat_complete_quantity.values[0][0]}catch(i){console.log("没有更新的数据"),clearInterval(t.myvar),t.ifFlash=!1}console.log(t.last_timestamp_comp),t.drawLineChart()}else t.$message({message:s,type:"error"}),t.listLoading=!1})},reflash:function(){this.ifFlash=!1,this.last_timestamp_comp="",this.getStart()},getStart:function(){this.getOrderStats(),this.getTestStationStats(),this.getProductStats()}},mounted:function(){this.user_id=this.$route.params.user_id||1,this.order_num=this.$route.params.order_num||"2019071653101549",this.getStart()}}),m=u,d=(a("31b6"),a("17cc")),p=Object(d["a"])(m,s,i,!1,null,"27fc4d96",null);e["default"]=p.exports},"4f45":function(t,e,a){(function(t){var s="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(i.call(setTimeout,s,arguments),clearTimeout)},e.setInterval=function(){return new n(i.call(setInterval,s,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(s,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a("de8a"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,a("66fa"))},cb1d:function(t,e,a){"use strict";function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,"a",function(){return s})},de8a:function(t,e,a){(function(t,e){(function(t,a){"use strict";if(!t.setImmediate){var s,i=1,n={},o=!1,r=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?p():f()?g():t.MessageChannel?h():r&&"onreadystatechange"in r.createElement("script")?_():v(),l.setImmediate=c,l.clearImmediate=u}function c(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var o={callback:t,args:e};return n[i]=o,s(i),i++}function u(t){delete n[t]}function m(t){var e=t.callback,s=t.args;switch(s.length){case 0:e();break;case 1:e(s[0]);break;case 2:e(s[0],s[1]);break;case 3:e(s[0],s[1],s[2]);break;default:e.apply(a,s);break}}function d(t){if(o)setTimeout(d,0,t);else{var e=n[t];if(e){o=!0;try{m(e)}finally{u(t),o=!1}}}}function p(){s=function(t){e.nextTick(function(){d(t)})}}function f(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}function g(){var e="setImmediate$"+Math.random()+"$",a=function(a){a.source===t&&"string"===typeof a.data&&0===a.data.indexOf(e)&&d(+a.data.slice(e.length))};t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),s=function(a){t.postMessage(e+a,"*")}}function h(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;d(e)},s=function(e){t.port2.postMessage(e)}}function _(){var t=r.documentElement;s=function(e){var a=r.createElement("script");a.onreadystatechange=function(){d(e),a.onreadystatechange=null,t.removeChild(a),a=null},t.appendChild(a)}}function v(){s=function(t){setTimeout(d,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,a("66fa"),a("4c39"))}}]);
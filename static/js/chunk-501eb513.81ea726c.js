(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-501eb513"],{1935:function(t,e){t.exports=function(t,e,a,l){var o="undefined"!==typeof l?[l,t]:[t],i=new Blob(o,{type:a||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(i,e);else{var s=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=s,r.setAttribute("download",e),"undefined"===typeof r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s)}}},"38b1":function(t,e,a){"use strict";var l=a("614a"),o=a.n(l);o.a},"614a":function(t,e,a){},"9f17":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"用户ID"},model:{value:t.user_id,callback:function(e){t.user_id=e},expression:"user_id"}},[a("template",{slot:"prepend"},[t._v("用户ID检索")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getStart},slot:"append"})],2)],1),a("el-form-item",{staticClass:"right"},[a("el-button",{attrs:{type:"primary",disabled:t.btnAble},on:{click:t.handleAdd}},[t._v("对该用户上传更新")])],1)],1)],1),a("el-col",{staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.detailForm,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"user_id",label:"当前用户ID",width:"100"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"grant_time_out",label:"授权到期时间",formatter:t.formatDate}}),a("el-table-column",{attrs:{prop:"company_name",label:"公司名称"}})],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.detailForm,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"order_cnt",label:"已生成订单量",width:"180"}}),a("el-table-column",{attrs:{prop:"register_time",label:"注册时间",width:"180"}}),a("el-table-column",{attrs:{prop:"retest_times",label:"测试不良品重测次数",width:"190"}}),a("el-table-column",{attrs:{prop:"order_close_timeout",label:"订单自动关闭延时（小时）",width:"220"}}),a("el-table-column",{attrs:{prop:"version_id",label:"目前pc端版本号"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注"}})],1)],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-tag",{staticClass:"txt1"},[t._v("更新历史列表")])],1),a("el-col",{staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.historyList,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"user_id",label:"用户ID",width:"100"}}),a("el-table-column",{attrs:{prop:"version_id",label:"版本号"}}),a("el-table-column",{attrs:{prop:"description",label:"更新说明"}}),a("el-table-column",{attrs:{prop:"add_time",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"file_md5",label:"文件md5"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-download"},on:{click:function(a){return t.handleExport(e.row)}}},[t._v("导出")])]}}])})],1)],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":t.pageLimit,total:t.total},on:{"current-change":t.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"文件上传",visible:t.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addFormVisible=e}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"80px",rules:t.addFormRules}},[a("el-form-item",{attrs:{label:"用户ID",prop:"user_id"}},[a("el-input",{attrs:{disabled:""},model:{value:t.user_id,callback:function(e){t.user_id=e},expression:"user_id"}})],1),a("el-form-item",{attrs:{label:"更新说明"}},[a("el-input",{model:{value:t.addForm.description,callback:function(e){t.$set(t.addForm,"description",e)},expression:"addForm.description"}})],1),a("el-form-item",{attrs:{label:"版本号"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:99},model:{value:t.num1,callback:function(e){t.num1=e},expression:"num1"}}),t._v(".\n        "),a("el-input-number",{attrs:{"controls-position":"right",min:0,max:99},model:{value:t.num2,callback:function(e){t.num2=e},expression:"num2"}}),t._v(".\n        "),a("el-input-number",{attrs:{"controls-position":"right",min:0,max:99},model:{value:t.num3,callback:function(e){t.num3=e},expression:"num3"}})],1),a("el-form-item",{attrs:{label:"文件上传"}},[a("el-upload",{ref:"addForm.file",staticClass:"upload-demo center",attrs:{drag:"",action:t.doUpload,"before-upload":t.beforeUpload}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("\n            将文件拖到此处，或\n            "),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.addFormVisible=!1}}},[t._v("取消")])],1)],1)],1)},o=[],i=(a("34a3"),a("8b55")),s=a("1935"),r=a.n(s),n=a("4ec3"),d=a("f753"),c=a.n(d),u={data:function(){return{num1:"0",num2:"0",num3:"8",doUpload:"http://localhost/",user_id:0,detailForm:[],btnAble:!0,historyList:[],page:1,pageLimit:6,total:1,addForm:{description:"",file:""},addLoading:!1,addFormVisible:!1,addFormRules:{file:[{required:!0,message:"请输入姓名",trigger:"blur"}]}}},methods:{formatDate:function(t,e){var a=new Date(1e3*t.grant_time_out);return a.toLocaleDateString().replace(/\//g,"-")+" "+a.toTimeString().substr(0,8)},handleExport:function(t){var e={user_uid:t.user_id,version:t.version};console.log(e),Object(n["p"])(e).then(function(t){var e=t.code,a=t.msg;console.log(a),200==e&&(console.log("http://pvt4nwciv.bkt.clouddn.com/"+a.qiniu_file_name),c.a.get("http://pvt4nwciv.bkt.clouddn.com/"+a.qiniu_file_name,{responseType:"arraybuffer"}).then(function(t){r()(t.data,a.qiniu_file_name)}).catch(function(t){console.log(t)}))})},beforeUpload:function(t){var e=this;console.log(t);var a=new FormData;a.append("user_uid",this.user_id),a.append("description",this.addForm.description),a.append("version_id",this.num1+"."+this.num2+"."+this.num3),a.append("file",t),Object(n["a"])(a).then(function(t){var a=t.code,l=t.msg;console.log(l),e.addLoading=!1,200==a?e.$message({message:"提交成功",type:"success"}):e.$message({message:l,type:"error"}),e.$refs["addForm"].resetFields(),e.addFormVisible=!1,e.getStart()})},handleCurrentChange:function(t){this.page=t,this.getUpdateHis()},handleAdd:function(){this.addFormVisible=!0,this.addForm={description:"1231",file:""}},getStart:function(){this.getDetail(),this.getUpdateHis()},getDetail:function(){var t=this;if(this.user_id){var e={user_uid:this.user_id};Object(n["r"])(e).then(function(e){e.code;var a=e.msg;200==e.code?(t.btnAble=!1,t.detailForm=[a]):(t.btnAble=!0,t.$message({message:a,type:"error"}))})}else this.btnAble=!0,this.$message({message:"没有指定的用户，显示所有更新状况",type:"error"})},getUpdateHis:function(){var t=this,e={page:this.page,pageLimit:this.pageLimit};this.user_id&&(e["user_uid"]=this.user_id),Object(n["q"])(e).then(function(e){e.code;var a=e.msg;console.log(a),200==e.code?(t.total=a.total,t.historyList=i["a"].getList(a)):t.$message({message:a||"查询错误，接下来显示全部更新！",type:"error"})})}},mounted:function(){this.user_id=this.$route.params.user_id||1,console.log("get user_id  "+this.user_id),this.getStart()}},p=u,m=(a("38b1"),a("17cc")),b=Object(m["a"])(p,l,o,!1,null,"19199c02",null);e["default"]=b.exports}}]);
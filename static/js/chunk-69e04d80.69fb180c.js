(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69e04d80"],{1146:function(t,e,s){},"20fb":function(t,e,s){"use strict";var i=s("2638"),n=s.n(i),u=s("d282"),r=s("a142"),a=s("ea8e"),o=s("a8fa"),c=s("1325"),l=Object(u["a"])("stepper"),h=l[0],d=l[1],m=600,f=200;function p(t,e){return String(t)===String(e)}function k(t,e){var s=Math.pow(10,10);return Math.round((t+e)*s)/s}e["a"]=h({props:{value:null,integer:Boolean,disabled:Boolean,inputWidth:[Number,String],buttonSize:[Number,String],asyncChange:Boolean,disableInput:Boolean,decimalLength:Number,min:{type:[Number,String],default:1},max:{type:[Number,String],default:1/0},step:{type:[Number,String],default:1},defaultValue:{type:[Number,String],default:1},showPlus:{type:Boolean,default:!0},showMinus:{type:Boolean,default:!0}},data:function(){var t=Object(r["b"])(this.value)?this.value:this.defaultValue,e=this.format(t);return p(e,this.value)||this.$emit("input",e),{currentValue:e}},computed:{minusDisabled:function(){return this.disabled||this.currentValue<=this.min},plusDisabled:function(){return this.disabled||this.currentValue>=this.max},inputStyle:function(){var t={};return this.inputWidth&&(t.width=Object(a["a"])(this.inputWidth)),this.buttonSize&&(t.height=Object(a["a"])(this.buttonSize)),t},buttonStyle:function(){if(this.buttonSize){var t=Object(a["a"])(this.buttonSize);return{width:t,height:t}}}},watch:{value:function(t){p(t,this.currentValue)||(this.currentValue=this.format(t))},currentValue:function(t){this.$emit("input",t),this.$emit("change",t)}},methods:{filter:function(t){return t=String(t).replace(/[^0-9.-]/g,""),this.integer&&-1!==t.indexOf(".")&&(t=t.split(".")[0]),t},format:function(t){return t=this.filter(t),t=""===t?0:+t,t=Math.max(Math.min(this.max,t),this.min),Object(r["b"])(this.decimalLength)&&(t=t.toFixed(this.decimalLength)),t},onInput:function(t){var e=t.target.value;if(""!==e){var s=this.filter(e);if(Object(r["b"])(this.decimalLength)&&-1!==s.indexOf(".")){var i=s.split(".");s=i[0]+"."+i[1].slice(0,this.decimalLength)}p(e,s)||(t.target.value=s),this.emitChange(s)}},emitChange:function(t){this.asyncChange?(this.$emit("input",t),this.$emit("change",t)):this.currentValue=t},onChange:function(){var t=this.type;if(this[t+"Disabled"])this.$emit("overlimit",t);else{var e="minus"===t?-this.step:+this.step,s=this.format(k(+this.currentValue,e));this.emitChange(s),this.$emit(t)}},onFocus:function(t){this.$emit("focus",t)},onBlur:function(t){var e=this.format(t.target.value);t.target.value=e,this.currentValue=e,this.$emit("blur",t),Object(o["a"])()},longPressStep:function(){var t=this;this.longPressTimer=setTimeout((function(){t.onChange(t.type),t.longPressStep(t.type)}),f)},onTouchStart:function(){var t=this;clearTimeout(this.longPressTimer),this.isLongPress=!1,this.longPressTimer=setTimeout((function(){t.isLongPress=!0,t.onChange(),t.longPressStep()}),m)},onTouchEnd:function(t){clearTimeout(this.longPressTimer),this.isLongPress&&Object(c["c"])(t)}},render:function(){var t=this,e=arguments[0],s=function(e){return{on:{click:function(){t.type=e,t.onChange()},touchstart:function(){t.type=e,t.onTouchStart(e)},touchend:t.onTouchEnd,touchcancel:t.onTouchEnd}}};return e("div",{class:d()},[e("button",n()([{directives:[{name:"show",value:this.showMinus}],style:this.buttonStyle,class:d("minus",{disabled:this.minusDisabled})},s("minus")])),e("input",{attrs:{type:"number",role:"spinbutton","aria-valuemax":this.max,"aria-valuemin":this.min,"aria-valuenow":this.currentValue,disabled:this.disabled||this.disableInput},class:d("input"),domProps:{value:this.currentValue},style:this.inputStyle,on:{input:this.onInput,focus:this.onFocus,blur:this.onBlur}}),e("button",n()([{directives:[{name:"show",value:this.showPlus}],style:this.buttonStyle,class:d("plus",{disabled:this.plusDisabled})},s("plus")]))])}})},"214f":function(t,e,s){"use strict";var i=s("32e9"),n=s("2aba"),u=s("79e5"),r=s("be13"),a=s("2b4c");t.exports=function(t,e,s){var o=a(t),c=s(r,o,""[t]),l=c[0],h=c[1];u((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)}))&&(n(String.prototype,t,l),i(RegExp.prototype,o,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},"32d7":function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return u}));var i=s("a142");function n(){return!i["d"]&&/android/.test(navigator.userAgent.toLowerCase())}function u(){return!i["d"]&&/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase())}},4917:function(t,e,s){s("214f")("match",1,(function(t,e,s){return[function(s){"use strict";var i=t(this),n=void 0==s?void 0:s[e];return void 0!==n?n.call(s,i):new RegExp(s)[e](String(i))},s]}))},"565f":function(t,e,s){"use strict";var i=s("2638"),n=s.n(i),u=s("1988"),r=s("ad06"),a=s("7744"),o=s("dfaf"),c=s("1325"),l=s("a8fa"),h=s("d282"),d=s("a142"),m=s("ea8e"),f=Object(h["a"])("field"),p=f[0],k=f[1];e["a"]=p({inheritAttrs:!1,props:Object(u["a"])({},o["a"],{error:Boolean,readonly:Boolean,autosize:[Boolean,Object],leftIcon:String,rightIcon:String,clearable:Boolean,labelClass:null,labelWidth:[Number,String],labelAlign:String,inputAlign:String,errorMessage:String,errorMessageAlign:String,showWordLimit:Boolean,type:{type:String,default:"text"}}),data:function(){return{focused:!1}},watch:{value:function(){this.$nextTick(this.adjustSize)}},mounted:function(){this.format(),this.$nextTick(this.adjustSize)},computed:{showClear:function(){return this.clearable&&this.focused&&""!==this.value&&Object(d["b"])(this.value)&&!this.readonly},listeners:function(){var t=Object(u["a"])({},this.$listeners,{input:this.onInput,keypress:this.onKeypress,focus:this.onFocus,blur:this.onBlur});return delete t.click,t},labelStyle:function(){var t=this.labelWidth;if(t)return{width:Object(m["a"])(t)}}},methods:{focus:function(){this.$refs.input&&this.$refs.input.focus()},blur:function(){this.$refs.input&&this.$refs.input.blur()},format:function(t){if(void 0===t&&(t=this.$refs.input),t){var e=t,s=e.value,i=this.$attrs.maxlength;return"number"===this.type&&Object(d["b"])(i)&&s.length>i&&(s=s.slice(0,i),t.value=s),s}},onInput:function(t){t.target.composing||this.$emit("input",this.format(t.target))},onFocus:function(t){this.focused=!0,this.$emit("focus",t),this.readonly&&this.blur()},onBlur:function(t){this.focused=!1,this.$emit("blur",t),Object(l["a"])()},onClick:function(t){this.$emit("click",t)},onClickLeftIcon:function(t){this.$emit("click-left-icon",t)},onClickRightIcon:function(t){this.$emit("click-right-icon",t)},onClear:function(t){Object(c["c"])(t),this.$emit("input",""),this.$emit("clear",t)},onKeypress:function(t){if("number"===this.type){var e=t.keyCode,s=-1===String(this.value).indexOf("."),i=e>=48&&e<=57||46===e&&s||45===e;i||Object(c["c"])(t)}"search"===this.type&&13===t.keyCode&&this.blur(),this.$emit("keypress",t)},adjustSize:function(){var t=this.$refs.input;if("textarea"===this.type&&this.autosize&&t){t.style.height="auto";var e=t.scrollHeight;if(Object(d["c"])(this.autosize)){var s=this.autosize,i=s.maxHeight,n=s.minHeight;i&&(e=Math.min(e,i)),n&&(e=Math.max(e,n))}e&&(t.style.height=e+"px")}},renderInput:function(){var t=this.$createElement,e=this.slots("input");if(e)return t("div",{class:k("control",this.inputAlign)},[e]);var s={ref:"input",class:k("control",this.inputAlign),domProps:{value:this.value},attrs:Object(u["a"])({},this.$attrs,{readonly:this.readonly}),on:this.listeners,directives:[{name:"model",value:this.value}]};return"textarea"===this.type?t("textarea",n()([{},s])):t("input",n()([{attrs:{type:this.type}},s]))},renderLeftIcon:function(){var t=this.$createElement,e=this.slots("left-icon")||this.leftIcon;if(e)return t("div",{class:k("left-icon"),on:{click:this.onClickLeftIcon}},[this.slots("left-icon")||t(r["a"],{attrs:{name:this.leftIcon}})])},renderRightIcon:function(){var t=this.$createElement,e=this.slots,s=e("right-icon")||this.rightIcon;if(s)return t("div",{class:k("right-icon"),on:{click:this.onClickRightIcon}},[e("right-icon")||t(r["a"],{attrs:{name:this.rightIcon}})])},renderWordLimit:function(){var t=this.$createElement;if(this.showWordLimit&&this.$attrs.maxlength)return t("div",{class:k("word-limit")},[this.value.length,"/",this.$attrs.maxlength])}},render:function(){var t,e=arguments[0],s=this.slots,i=this.labelAlign,n={icon:this.renderLeftIcon};return s("label")&&(n.title=function(){return s("label")}),e(a["a"],{attrs:{icon:this.leftIcon,size:this.size,title:this.label,center:this.center,border:this.border,isLink:this.isLink,required:this.required,clickable:this.clickable,titleStyle:this.labelStyle,titleClass:[k("label",i),this.labelClass],arrowDirection:this.arrowDirection},class:k((t={error:this.error},t["label-"+i]=i,t["min-height"]="textarea"===this.type&&!this.autosize,t)),scopedSlots:n,on:{click:this.onClick}},[e("div",{class:k("body")},[this.renderInput(),this.showClear&&e(r["a"],{attrs:{name:"clear"},class:k("clear"),on:{touchstart:this.onClear}}),this.renderRightIcon(),s("button")&&e("div",{class:k("button")},[s("button")])]),this.renderWordLimit(),this.errorMessage&&e("div",{class:k("error-message",this.errorMessageAlign)},[this.errorMessage])])}})},a8fa:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));var i=s("32d7"),n=s("a8c1"),u=Object(i["b"])();function r(){u&&Object(n["e"])(Object(n["b"])())}},b333:function(t,e,s){"use strict";s.r(e);var i=s("bd86"),n=(s("8a58"),s("e41f")),u=(s("7f7f"),s("68ef"),s("4d75"),s("09fe"),s("b258"),s("8270"),s("786d"),s("504b"),s("fb6c"),s("1146"),s("bcd3"),s("d10a"),{"zh-CN":{vanSku:{select:"选择",selected:"已选",selectSku:"请先选择商品规格",soldout:"库存不足",originPrice:"原价",minusTip:"至少选择一件",unavailable:"商品已经无法购买啦",stock:"剩余",stockUnit:"件",quotaLimit:function(t){return"每人限购"+t+"件"},quotaCount:function(t){return"你已购买"+t+"件"}},vanSkuActions:{buy:"立即购买",addCart:"加入购物车"},vanSkuImgUploader:{oversize:function(t){return"最大可上传图片为"+t+"MB，请尝试压缩图片尺寸"},fail:"上传失败<br />重新上传"},vanSkuStepper:{num:"购买数量"},vanSkuMessages:{fill:"请填写",upload:"请上传",imageLabel:"仅限一张",invalid:{tel:"请填写正确的数字格式留言",mobile:"手机号长度为6-20位数字",email:"请填写正确的邮箱",id_no:"请填写正确的身份证号码"},placeholder:{id_no:"输入身份证号码",text:"输入文本",tel:"输入数字",email:"输入邮箱",date:"点击选择日期",time:"点击选择时间",textarea:"点击填写段落文本",mobile:"输入手机号码"}}}}),r=s("3c69"),a=s("1988"),o=s("2b0e"),c=s("d399"),l=s("28a2"),h=s("2638"),d=s.n(h),m=s("d282"),f=s("ba31"),p=s("b1d2"),k=Object(m["a"])("sku-header"),g=k[0],v=k[1];function b(t,e){var s;return t.tree.some((function(t){var i=e[t.k_s];if(i&&t.v){var n=t.v.filter((function(t){return t.id===i}))[0]||{};return s=n.previewImgUrl||n.imgUrl||n.img_url,s}return!1})),s}function S(t,e,s,i){var n=e.sku,u=e.goods,r=e.skuEventBus,a=e.selectedSku,o=b(n,a)||u.picture,c=function(){r.$emit("sku:previewImage",o)};return t("div",d()([{class:[v(),p["c"]]},Object(f["b"])(i)]),[t("div",{class:v("img-wrap"),on:{click:c}},[t("img",{attrs:{src:o}})]),t("div",{class:v("goods-info")},[s.default&&s.default()])])}S.props={sku:Object,goods:Object,skuEventBus:Object,selectedSku:Object};var y=g(S),F=Object(m["a"])("sku-header-item"),C=F[0],x=F[1];function O(t,e,s,i){return t("div",d()([{class:x()},Object(f["b"])(i)]),[s.default&&s.default()])}var T=C(O),j=Object(m["a"])("sku-row"),I=j[0],$=j[1];function w(t,e,s,i){return t("div",d()([{class:[$(),p["c"]]},Object(f["b"])(i)]),[t("div",{class:$("title")},[e.skuRow.k]),s.default&&s.default()])}w.props={skuRow:Object};var _=I(w),B={QUOTA_LIMIT:0,STOCK_LIMIT:1},E="",M={LIMIT_TYPE:B,UNSELECTED_SKU_VALUE_ID:E},L=function(t){var e={};return t.forEach((function(t){e[t.k_s]=t.v})),e},N=function(t,e){var s=Object.keys(e).filter((function(t){return e[t]!==E}));return t.length===s.length},D=function(t,e){var s=t.filter((function(t){return Object.keys(e).every((function(s){return String(t[s])===String(e[s])}))}));return s[0]},A=function(t,e){var s=L(t);return Object.keys(e).reduce((function(t,i){var n=s[i],u=e[i];if(u!==E){var r=n.filter((function(t){return t.id===u}))[0];r&&t.push(r)}return t}),[])},V=function(t,e,s){var i,n=s.key,u=s.valueId,r=Object(a["a"])({},e,(i={},i[n]=u,i)),o=Object.keys(r).filter((function(t){return r[t]!==E})),c=t.filter((function(t){return o.every((function(e){return String(r[e])===String(t[e])}))})),l=c.reduce((function(t,e){return t+=e.stock_num,t}),0);return l>0},z={normalizeSkuTree:L,getSkuComb:D,getSelectedSkuValues:A,isAllSelected:N,isSkuChoosable:V},q=Object(m["a"])("sku-row-item"),P=q[0],U=P({props:{skuValue:Object,skuKeyStr:String,skuEventBus:Object,selectedSku:Object,skuList:{type:Array,default:function(){return[]}}},computed:{choosable:function(){return V(this.skuList,this.selectedSku,{key:this.skuKeyStr,valueId:this.skuValue.id})}},methods:{onSelect:function(){this.choosable&&this.skuEventBus.$emit("sku:select",Object(a["a"])({},this.skuValue,{skuKeyStr:this.skuKeyStr}))}},render:function(){var t=arguments[0],e=this.skuValue.id===this.selectedSku[this.skuKeyStr],s=this.skuValue.imgUrl||this.skuValue.img_url;return t("span",{class:["van-sku-row__item",{"van-sku-row__item--active":e,"van-sku-row__item--disabled":!this.choosable}],on:{click:this.onSelect}},[s&&t("img",{class:"van-sku-row__item-img",attrs:{src:s}}),t("span",{class:"van-sku-row__item-name"},[this.skuValue.name])])}}),K=s("20fb"),R=Object(m["a"])("sku-stepper"),H=R[0],W=R[2],Q=B.QUOTA_LIMIT,G=B.STOCK_LIMIT,J=H({props:{stock:Number,skuEventBus:Object,skuStockNum:Number,selectedNum:Number,stepperTitle:String,disableStepperInput:Boolean,customStepperConfig:Object,quota:{type:Number,default:0},quotaUsed:{type:Number,default:0}},data:function(){return{currentNum:this.selectedNum,limitType:G}},watch:{currentNum:function(t){this.skuEventBus.$emit("sku:numChange",t)},stepperLimit:function(t){t<this.currentNum&&(this.currentNum=t)}},computed:{stepperLimit:function(){var t,e=this.quota-this.quotaUsed;return this.quota>0&&e<=this.stock?(t=e<0?0:e,this.limitType=Q):(t=this.stock,this.limitType=G),t}},methods:{setCurrentNum:function(t){this.currentNum=t},onOverLimit:function(t){this.skuEventBus.$emit("sku:overLimit",{action:t,limitType:this.limitType,quota:this.quota,quotaUsed:this.quotaUsed})},onChange:function(t){var e=this.customStepperConfig.handleStepperChange;e&&e(t),this.$emit("change",t)}},render:function(){var t=this,e=arguments[0];return e("div",{class:"van-sku-stepper-stock"},[e("div",{class:"van-sku-stepper-container"},[e("div",{class:"van-sku__stepper-title"},[this.stepperTitle||W("num")]),e(K["a"],{class:"van-sku__stepper",attrs:{max:this.stepperLimit,disableInput:this.disableStepperInput},on:{overlimit:this.onOverLimit,change:this.onChange},model:{value:t.currentNum,callback:function(e){t.currentNum=e}}})])])}}),Y=s("7744"),X=s("34e9"),Z=s("565f");function tt(t){var e=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;return e.test(t)}var et=s("90c6"),st=s("ad06"),it=s("543e"),nt=s("8f80"),ut=Object(m["a"])("sku-img-uploader"),rt=ut[0],at=ut[1],ot=ut[2],ct=rt({props:{value:String,uploadImg:Function,maxSize:{type:Number,default:6}},data:function(){return{paddingImg:"",uploadFail:!1}},methods:{afterReadFile:function(t){var e=this;this.paddingImg=t.content,this.uploadFail=!1,this.uploadImg(t.file,t.content).then((function(t){e.$emit("input",t),e.$nextTick((function(){e.paddingImg=""}))})).catch((function(){e.uploadFail=!0}))},onOversize:function(){this.$toast(ot("oversize",this.maxSize))},renderUploader:function(t,e){void 0===e&&(e=!1);var s=this.$createElement;return s(nt["a"],{class:at("uploader"),attrs:{disabled:e,afterRead:this.afterReadFile,maxSize:1024*this.maxSize*1024},on:{oversize:this.onOversize}},[s("div",{class:at("img")},[t])])},renderMask:function(){var t=this.$createElement;return t("div",{class:at("mask")},[this.uploadFail?[t(st["a"],{attrs:{name:"warning-o",size:"20px"}}),t("div",{class:at("warn-text"),domProps:{innerHTML:ot("fail")}})]:t(it["a"],{attrs:{type:"spinner",size:"20px",color:"white"}})])}},render:function(){var t=this,e=arguments[0];return e("div",{class:at()},[this.value&&this.renderUploader([e("img",{attrs:{src:this.value}}),e(st["a"],{attrs:{name:"clear"},class:at("delete"),on:{click:function(){t.$emit("input","")}}})],!0),this.paddingImg&&this.renderUploader([e("img",{attrs:{src:this.paddingImg}}),this.renderMask()],!this.uploadFail),!this.value&&!this.paddingImg&&this.renderUploader(e("div",{class:at("trigger")},[e(st["a"],{attrs:{name:"photograph",size:"22px"}})]))])}}),lt=Object(m["a"])("sku-messages"),ht=lt[0],dt=lt[1],mt=lt[2],ft=ht({props:{messages:{type:Array,default:function(){return[]}},messageConfig:Object,goodsId:[Number,String]},data:function(){return{messageValues:this.resetMessageValues(this.messages)}},watch:{messages:function(t){this.messageValues=this.resetMessageValues(t)}},methods:{resetMessageValues:function(t){return(t||[]).map((function(){return{value:""}}))},getType:function(t){return 1===+t.multiple?"textarea":"id_no"===t.type?"text":t.datetime>0?"datetime-local":t.type},getMessages:function(){var t=this,e={};return this.messageValues.forEach((function(s,i){var n=s.value;t.messages[i].datetime>0&&(n=n.replace(/T/g," ")),e["message_"+i]=n})),e},getCartMessages:function(){var t=this,e={};return this.messageValues.forEach((function(s,i){var n=s.value,u=t.messages[i];u.datetime>0&&(n=n.replace(/T/g," ")),e[u.name]=n})),e},getPlaceholder:function(t){var e=1===+t.multiple?"textarea":t.type,s=this.messageConfig.placeholderMap||{};return t.placeholder||s[e]||mt("placeholder."+e)},validateMessages:function(){for(var t=this.messageValues,e=0;e<t.length;e++){var s=t[e].value,i=this.messages[e];if(""===s){if("1"===String(i.required)){var n=mt("image"===i.type?"upload":"fill");return n+i.name}}else{if("tel"===i.type&&!Object(et["a"])(s))return mt("invalid.tel");if("mobile"===i.type&&!/^\d{6,20}$/.test(s))return mt("invalid.mobile");if("email"===i.type&&!tt(s))return mt("invalid.email");if("id_no"===i.type&&(s.length<15||s.length>18))return mt("invalid.id_no")}}}},render:function(){var t=this,e=arguments[0];return e(X["a"],{class:dt(),attrs:{border:this.messages.length>0}},[this.messages.map((function(s,i){return"image"===s.type?e(Y["a"],{class:dt("image-cell"),attrs:{"value-class":dt("image-cell-value"),label:mt("imageLabel"),title:s.name,required:"1"===String(s.required)},key:t.goodsId+"-"+i},[e(ct,{attrs:{uploadImg:t.messageConfig.uploadImg,maxSize:t.messageConfig.uploadMaxSize},model:{value:t.messageValues[i].value,callback:function(e){t.messageValues[i].value=e}}})]):e(Z["a"],{attrs:{maxlength:"200",label:s.name,required:"1"===String(s.required),placeholder:t.getPlaceholder(s),type:t.getType(s)},key:t.goodsId+"-"+i,model:{value:t.messageValues[i].value,callback:function(e){t.messageValues[i].value=e}}})}))])}}),pt=s("b650"),kt=Object(m["a"])("sku-actions"),gt=kt[0],vt=kt[1],bt=kt[2];function St(t,e,s,i){var n=function(t){return function(){e.skuEventBus.$emit(t)}};return t("div",d()([{class:vt()},Object(f["b"])(i)]),[e.showAddCartBtn&&t(pt["a"],{attrs:{size:"large",type:"warning",text:e.addCartText||bt("addCart")},on:{click:n("sku:addCart")}}),t(pt["a"],{attrs:{size:"large",type:"danger",text:e.buyText||bt("buy")},on:{click:n("sku:buy")}})])}St.props={buyText:String,addCartText:String,skuEventBus:Object,showAddCartBtn:Boolean};var yt=gt(St),Ft=s("a142"),Ct=Object(m["a"])("sku"),xt=Ct[0],Ot=Ct[1],Tt=Ct[2],jt=B.QUOTA_LIMIT,It=xt({props:{sku:Object,priceTag:String,goods:Object,value:Boolean,buyText:String,goodsId:[Number,String],hideStock:Boolean,addCartText:String,stepperTitle:String,getContainer:Function,hideQuotaText:Boolean,hideSelectedText:Boolean,resetStepperOnHide:Boolean,customSkuValidator:Function,closeOnClickOverlay:Boolean,disableStepperInput:Boolean,safeAreaInsetBottom:Boolean,resetSelectedSkuOnHide:Boolean,quota:{type:Number,default:0},quotaUsed:{type:Number,default:0},initialSku:{type:Object,default:function(){return{}}},stockThreshold:{type:Number,default:50},showSoldoutSku:{type:Boolean,default:!0},showAddCartBtn:{type:Boolean,default:!0},bodyOffsetTop:{type:Number,default:200},messageConfig:{type:Object,default:function(){return{placeholderMap:{},uploadImg:function(){return Promise.resolve()},uploadMaxSize:5}}},customStepperConfig:{type:Object,default:function(){return{}}}},data:function(){return{selectedSku:{},selectedNum:1,show:this.value}},watch:{show:function(t){this.$emit("input",t),t||(this.$emit("sku-close",{selectedSkuValues:this.selectedSkuValues,selectedNum:this.selectedNum,selectedSkuComb:this.selectedSkuComb}),this.resetStepperOnHide&&this.resetStepper(),this.resetSelectedSkuOnHide&&this.resetSelectedSku(this.skuTree))},value:function(t){this.show=t},skuTree:"resetSelectedSku",initialSku:function(){this.resetStepper(),this.resetSelectedSku(this.skuTree)}},computed:{skuGroupClass:function(){return["van-sku-group-container",{"van-sku-group-container--hide-soldout":!this.showSoldoutSku}]},bodyStyle:function(){if(!this.$isServer){var t=window.innerHeight-this.bodyOffsetTop;return{maxHeight:t+"px"}}},isSkuCombSelected:function(){return N(this.sku.tree,this.selectedSku)},isSkuEmpty:function(){return 0===Object.keys(this.sku).length},hasSku:function(){return!this.sku.none_sku},selectedSkuComb:function(){return this.hasSku?this.isSkuCombSelected?D(this.sku.list,this.selectedSku):null:{id:this.sku.collection_id,price:Math.round(100*this.sku.price),stock_num:this.sku.stock_num}},selectedSkuValues:function(){return A(this.skuTree,this.selectedSku)},price:function(){return this.selectedSkuComb?(this.selectedSkuComb.price/100).toFixed(2):this.sku.price},originPrice:function(){return this.selectedSkuComb&&this.selectedSkuComb.origin_price?(this.selectedSkuComb.origin_price/100).toFixed(2):this.sku.origin_price},skuTree:function(){return this.sku.tree||[]},imageList:function(){var t=[this.goods.picture];return this.skuTree.length>0&&this.skuTree.forEach((function(e){e.v&&e.v.forEach((function(e){var s=e.previewImgUrl||e.imgUrl||e.img_url;s&&t.push(s)}))})),t},stock:function(){var t=this.customStepperConfig.stockNum;return void 0!==t?t:this.selectedSkuComb?this.selectedSkuComb.stock_num:this.sku.stock_num},stockText:function(){var t=this.$createElement,e=this.customStepperConfig.stockFormatter;return e?e(this.stock):[Tt("stock")+" ",t("span",{class:Ot("stock-num",{highlight:this.stock<this.stockThreshold})},[this.stock])," "+Tt("stockUnit")]},quotaText:function(){var t=this.customStepperConfig,e=t.quotaText,s=t.hideQuotaText;if(s)return"";var i="";return e?i=e:this.quota>0&&(i=Tt("quotaLimit",this.quota)),i},selectedText:function(){var t=this;if(this.selectedSkuComb)return Tt("selected")+" "+this.selectedSkuValues.map((function(t){return t.name})).join("；");var e=this.skuTree.filter((function(e){return t.selectedSku[e.k_s]===E})).map((function(t){return t.k})).join("；");return Tt("select")+" "+e}},created:function(){var t=new o["a"];this.skuEventBus=t,t.$on("sku:select",this.onSelect),t.$on("sku:numChange",this.onNumChange),t.$on("sku:previewImage",this.onPreviewImage),t.$on("sku:overLimit",this.onOverLimit),t.$on("sku:addCart",this.onAddCart),t.$on("sku:buy",this.onBuy),this.resetStepper(),this.resetSelectedSku(this.skuTree),this.$emit("after-sku-create",t)},methods:{resetStepper:function(){var t=this.$refs.skuStepper,e=this.initialSku.selectedNum,s=Object(Ft["b"])(e)?e:1;t?t.setCurrentNum(s):this.selectedNum=s},resetSelectedSku:function(t){var e=this;this.selectedSku={},t.forEach((function(t){e.selectedSku[t.k_s]=e.initialSku[t.k_s]||E})),t.forEach((function(t){var s=t.k_s,i=t.v[0].id;1===t.v.length&&V(e.sku.list,e.selectedSku,{key:s,valueId:i})&&(e.selectedSku[s]=i)}));var s=this.selectedSkuValues;s.length>0&&this.$nextTick((function(){e.$emit("sku-selected",{skuValue:s[s.length-1],selectedSku:e.selectedSku,selectedSkuComb:e.selectedSkuComb})}))},getSkuMessages:function(){return this.$refs.skuMessages?this.$refs.skuMessages.getMessages():{}},getSkuCartMessages:function(){return this.$refs.skuMessages?this.$refs.skuMessages.getCartMessages():{}},validateSkuMessages:function(){return this.$refs.skuMessages?this.$refs.skuMessages.validateMessages():""},validateSku:function(){if(0===this.selectedNum)return Tt("unavailable");if(this.isSkuCombSelected)return this.validateSkuMessages();if(this.customSkuValidator){var t=this.customSkuValidator(this);if(t)return t}return Tt("selectSku")},onSelect:function(t){var e,s;this.selectedSku=this.selectedSku[t.skuKeyStr]===t.id?Object(a["a"])({},this.selectedSku,(e={},e[t.skuKeyStr]=E,e)):Object(a["a"])({},this.selectedSku,(s={},s[t.skuKeyStr]=t.id,s)),this.$emit("sku-selected",{skuValue:t,selectedSku:this.selectedSku,selectedSkuComb:this.selectedSkuComb})},onNumChange:function(t){this.selectedNum=t},onPreviewImage:function(t){var e=this,s=this.imageList.findIndex((function(e){return e===t})),i={index:s,imageList:this.imageList,indexImage:t};this.$emit("open-preview",i),Object(l["a"])({images:this.imageList,startPosition:s,closeOnPopstate:!0,onClose:function(){e.$emit("close-preview",i)}})},onOverLimit:function(t){var e=t.action,s=t.limitType,i=t.quota,n=t.quotaUsed,u=this.customStepperConfig.handleOverLimit;if(u)u(t);else if("minus"===e)Object(c["a"])(Tt("minusTip"));else if("plus"===e)if(s===jt){var r=Tt("quotaLimit",i);n>0&&(r+="，"+Tt("quotaCount",n)),Object(c["a"])(r)}else Object(c["a"])(Tt("soldout"))},onAddCart:function(){this.onBuyOrAddCart("add-cart")},onBuy:function(){this.onBuyOrAddCart("buy-clicked")},onBuyOrAddCart:function(t){var e=this.validateSku();e?Object(c["a"])(e):this.$emit(t,this.getSkuData())},getSkuData:function(){return{goodsId:this.goodsId,selectedNum:this.selectedNum,selectedSkuComb:this.selectedSkuComb,messages:this.getSkuMessages(),cartMessages:this.getSkuCartMessages()}}},render:function(){var t=this,e=arguments[0];if(!this.isSkuEmpty){var s=this.sku,i=this.goods,u=this.price,r=this.originPrice,a=this.skuEventBus,o=this.selectedSku,c=this.selectedNum,l=this.stepperTitle,h=this.hideQuotaText,d=this.selectedSkuComb,m={price:u,originPrice:r,selectedNum:c,skuEventBus:a,selectedSku:o,selectedSkuComb:d},f=function(e){return t.slots(e,m)},p=f("sku-header")||e(y,{attrs:{sku:s,goods:i,skuEventBus:a,selectedSku:o}},[f("sku-header-price")||e("div",{class:"van-sku__goods-price"},[e("span",{class:"van-sku__price-symbol"},["￥"]),e("span",{class:"van-sku__price-num"},[u]),this.priceTag&&e("span",{class:"van-sku__price-tag"},[this.priceTag])]),f("sku-header-origin-price")||r&&e(T,[Tt("originPrice")," ￥",r]),!this.hideStock&&e(T,[e("span",{class:"van-sku__stock"},[this.stockText]),!h&&this.quotaText&&e("span",{class:"van-sku__quota"},["(",this.quotaText,")"])]),this.hasSku&&!this.hideSelectedText&&e(T,[this.selectedText]),f("sku-header-extra")]),k=f("sku-group")||this.hasSku&&e("div",{class:this.skuGroupClass},[this.skuTree.map((function(t){return e(_,{attrs:{skuRow:t}},[t.v.map((function(i){return e(U,{attrs:{skuList:s.list,skuValue:i,selectedSku:o,skuEventBus:a,skuKeyStr:t.k_s}})}))])}))]),g=f("sku-stepper")||e(J,{ref:"skuStepper",attrs:{stock:this.stock,quota:this.quota,quotaUsed:this.quotaUsed,skuEventBus:a,selectedNum:c,selectedSku:o,stepperTitle:l,skuStockNum:s.stock_num,disableStepperInput:this.disableStepperInput,customStepperConfig:this.customStepperConfig},on:{change:function(e){t.$emit("stepper-change",e)}}}),v=f("sku-messages")||e(ft,{ref:"skuMessages",attrs:{goodsId:this.goodsId,messageConfig:this.messageConfig,messages:s.messages}}),b=f("sku-actions")||e(yt,{attrs:{buyText:this.buyText,skuEventBus:a,addCartText:this.addCartText,showAddCartBtn:this.showAddCartBtn}});return e(n["a"],{attrs:{round:!0,closeable:!0,position:"bottom",getContainer:this.getContainer,closeOnClickOverlay:this.closeOnClickOverlay,safeAreaInsetBottom:this.safeAreaInsetBottom},class:"van-sku-container",model:{value:t.show,callback:function(e){t.show=e}}},[p,e("div",{class:"van-sku-body",style:this.bodyStyle},[f("sku-body-top"),k,f("extra-sku-group"),g,v]),b])}}});r["a"].add(u),It.SkuActions=yt,It.SkuHeader=y,It.SkuHeaderItem=T,It.SkuMessages=ft,It.SkuStepper=J,It.SkuRow=_,It.SkuRowItem=U,It.skuHelper=z,It.skuConstants=M;var $t,wt=It;s("4917"),e["default"]={props:{selectSku:Object},data:function(){return{showSku:!1,showAddCartBtn:!1,isSkuBuy:!1,buyText:"确定"}},methods:{buyGoods:function(t){t=this.selectSkuData(t),this.showSku=!1,this.$emit("update:selectSku",t),this.isSkuBuy&&this.$emit("skuBuy",t)},selectSkuData:function(t){return t.selectedSkuComb?t.selectedSkuComb.sku_str=t.selectedSkuComb.props_str_arr.map((function(t){return t.match(/[^:]*:([^:]*)/)[1]})).join(","):t.selectedSkuComb={},t},skuClick:function(){this.isSkuBuy=!1,this.showSku=!0}},components:($t={},Object(i["a"])($t,wt.name,wt),Object(i["a"])($t,n["a"].name,n["a"]),$t)}},d10a:function(t,e,s){},fb6c:function(t,e,s){}}]);